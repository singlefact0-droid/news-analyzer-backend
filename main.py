import openai

openai.api_key = "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"

@app.post("/analyze")
async def analyze(article: Article):
    text = article.article
    if not text.strip():
        return {"credibility_score": None, "summary": "Empty input.", "counterarguments": "N/A"}

    prompt = f"""
    Analyze the credibility of this news article and give:
    1. Credibility score out of 100%
    2. Short summary
    3. Counterarguments against its claims

    Article: {text}
    """

    response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo",
        messages=[{"role": "user", "content": prompt}]
    )

    output = response.choices[0].message["content"]

    # You can parse the output better later
    return {
        "credibility_score": "AI-generated",
        "summary": output,
        "counterarguments": "Generated by AI"
    }
